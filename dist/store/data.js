!function(){var e={9852:function(e){function t(e,t,r){t="number"==typeof t?o(t.toString()):"string"==typeof t?o(t):t;const i=(e,t,r,o)=>{let u,c=t[o];return t.length>o?(Array.isArray(e)?(c=n(c,e),u=e.slice()):u=Object.assign({},e),u[c]=i(void 0!==e[c]?e[c]:{},t,r,o+1),u):"function"==typeof r?r(e):r};return i(e,t,r,0)}function r(e,t,r){t="number"==typeof t?o(t.toString()):"string"==typeof t?o(t):t;for(var n=0;n<t.length;n++){if(null===e||"object"!=typeof e)return r;let o=t[n];Array.isArray(e)&&"$end"===o&&(o=e.length-1),e=e[o]}return void 0===e?r:e}function n(e,t){if("$end"===e&&(e=Math.max(t.length-1,0)),!/^\+?\d+$/.test(e))throw new Error(`Array index '${e}' has to be an integer`);return parseInt(e)}function o(e){return e.split(".").reduce(((e,t,r,n)=>{const o=r>0&&n[r-1];if(o&&/(?:^|[^\\])\\$/.test(o)){const r=e.pop();e.push(r.slice(0,-1)+"."+t)}else e.push(t);return e}),[])}e.exports={set:t,get:r,delete:function(e,t){t="number"==typeof t?o(t.toString()):"string"==typeof t?o(t):t;const r=(e,t,o)=>{let i,u=t[o];return null===e||"object"!=typeof e||!Array.isArray(e)&&void 0===e[u]?e:t.length-1>o?(Array.isArray(e)?(u=n(u,e),i=e.slice()):i=Object.assign({},e),i[u]=r(e[u],t,o+1),i):(Array.isArray(e)?(u=n(u,e),i=[].concat(e.slice(0,u),e.slice(u+1))):(i=Object.assign({},e),delete i[u]),i)};return r(e,t,0)},toggle:function(e,n){const o=r(e,n);return t(e,n,!Boolean(o))},merge:function(e,n,o){const i=r(e,n);return"object"==typeof i?Array.isArray(i)?t(e,n,i.concat(o)):t(e,n,null===i?o:Object.assign({},i,o)):void 0===i?t(e,n,o):e}}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";var e={};r.r(e),r.d(e,{flash:function(){return x},getError:function(){return P},isInvalid:function(){return k},isSaving:function(){return j},selectErrors:function(){return M},selectModelErrors:function(){return T},selectValidationErrors:function(){return I},showUpgradeModal:function(){return R},snackbarNotices:function(){return D}});var t={};r.r(t),r.d(t,{addErrors:function(){return z},addModelErrors:function(){return q},addSnackbarNotice:function(){return $},addValidationErrors:function(){return B},clearErrors:function(){return Q},clearModelErrors:function(){return H},clearValidationErrors:function(){return Y},removeSnackbarNotice:function(){return G},setError:function(){return N},setFlash:function(){return F},setInvalid:function(){return V},setSaving:function(){return C},setUpgradeModal:function(){return U}});var n={};r.r(n),r.d(n,{getEditedEntityRecords:function(){return xe},getEntities:function(){return se},getEntity:function(){return ce},getEntityEditLink:function(){return fe},hasDirtyModels:function(){return Se},isCreated:function(){return pe},isDirty:function(){return Ae},isSaving:function(){return De},prepareFetchRequest:function(){return je},prepareUpdateRequest:function(){return Re},selectAllDrafts:function(){return Ee},selectAllModels:function(){return ye},selectCollection:function(){return he},selectDirty:function(){return Oe},selectDraft:function(){return _e},selectDrafts:function(){return we},selectEntities:function(){return le},selectEntity:function(){return ae},selectError:function(){return ve},selectModel:function(){return ge},selectPageId:function(){return de},selectRelation:function(){return be},selectSingleRelation:function(){return me}});var o={};r.r(o),r.d(o,{addDraft:function(){return Ft},addModel:function(){return Nt},addModels:function(){return Ct},clearDirty:function(){return Jt},clearDrafts:function(){return Kt},deleteModel:function(){return Yt},duplicateModel:function(){return zt},isDirty:function(){return nr},makeRequest:function(){return Zt},prepareSaveRequest:function(){return or},receiveModel:function(){return rr},receiveModels:function(){return Ht},registerEntities:function(){return It},removeDirty:function(){return $t},removeDraft:function(){return Gt},saveData:function(){return Wt},saveDraft:function(){return tr},saveDrafts:function(){return er},saveModel:function(){return Xt},setError:function(){return Mt},setModels:function(){return Lt},updateDirty:function(){return Qt},updateDraft:function(){return Bt},updateModel:function(){return qt},updateModels:function(){return Vt},updateModelsProperty:function(){return Ut}});var i=window.wp.data;function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=window.wp.i18n,l=r(9852),f=r.n(l);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=(0,i.combineReducers)({config:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.payload;return"REGISTER_ENTITIES"===r?[].concat(c(e),c(n)):e},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.payload,n=t.type;return"SET_ERROR"===n?r:e},drafts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.name,o=t.index,i=t.payload;switch(r){case"ADD_DRAFT":return p(p({},e),{},a({},n,[].concat(c(e[n]||[]),[i])));case"UPDATE_DRAFT":return f().merge(e,"".concat(n,".").concat(o),i);case"REMOVE_DRAFT":return f().delete(e,"".concat(n,".").concat(o));case"CLEAR_DRAFTS":return f().delete(e,n)}return e},entities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.name,o=t.id,i=t.payload;switch(r){case"SET_MODELS":return i;case"ADD_MODELS":return p(p({},e),i);case"UPDATE_MODEL":return f().merge(e,"".concat(n,".").concat(o),i);case"ADD_MODEL":case"SET_MODEL":return f().set(e,"".concat(null==i?void 0:i.object,".").concat(null==i?void 0:i.id),i);case"DELETE_MODEL":return f().delete(e,"".concat(n,".").concat(o))}return e},dirty:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.id,o=t.payload;switch(r){case"UPDATE_DIRTY":return f().merge(e,n,o);case"REMOVE_DIRTY":return"string"!=typeof n?e:f().delete(e,n);case"CLEAR_DIRTY":return{}}return e},saving:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_POST_UPDATE_START":case"REQUEST_POST_UPDATE_FINISH":return{pending:"REQUEST_POST_UPDATE_START"===t.type,options:t.options||{}}}return e}});function y(e,t,r,n,o,i,u){try{var c=e[i](u),a=c.value}catch(e){return void r(e)}c.done?t(a):Promise.resolve(a).then(n,o)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function u(e){y(i,n,o,u,c,"next",e)}function c(e){y(i,n,o,u,c,"throw",e)}u(void 0)}))}}function g(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var b=window.regeneratorRuntime,m=r.n(b),O=window.wp.apiFetch,E=r.n(O),w=window.wp.url,_=window.lodash;function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e){return e.snackbar||[]}function R(e){return"upgrade"===e.modal}function j(e){return e.saving.isSaving}function x(e){return e.errors.flash}function k(e){return e.errors.isInvalid}function P(e){return e.error}function T(e,t){return e.modelErrors[t]||[]}function M(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return e.errors.errors;var n=e.errors.errors.filter((function(e){return(null==e?void 0:e.key)&&e.key===t}));return null===r?n:n.filter((function(e){return(null==e?void 0:e.index)===r}))}function I(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=M(e,t,r),i=[];return o.length?(o.forEach((function(e){var t,r,o=e.error;null!=o&&null!==(t=o.additional_errors)&&void 0!==t&&t.length&&(i=[].concat(c(i),c(n?null==o||null===(r=o.additional_errors)||void 0===r?void 0:r.filter((function(e){var t;return(null==e||null===(t=e.data)||void 0===t?void 0:t.attribute)===n})):null==o?void 0:o.additional_errors)))})),i):i}(0,i.combineReducers)({saving:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isSaving:!1},t=arguments.length>1?arguments[1]:void 0;return"SET_SAVING"===t.type?A(A({},e),{},{isSaving:t.value}):e},error:function(e,t){return"SET_ERROR"===t.type?t.value:e},errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{flash:{},validation:[],isInvalid:0,errors:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_INVALID":return A(A({},e),{},{isInvalid:(null==e?void 0:e.isInvalid)+1});case"SET_SAVING":return A(A({},e),{},{isSaving:t.value});case"SET_FLASH":return A(A({},e),{},{flash:t.value});case"ADD_ERRORS":return A(A({},e),{},{errors:[].concat(c(e.errors),c(t.value))});case"CLEAR_ERRORS":return null!==(null==t?void 0:t.index)?A(A({},e),{},{errors:(e.errors||[]).filter((function(e){return e.index!==t.index}))}):A(A({},e),{},{errors:[]});case"ADD_VALIDATION_ERRORS":return A(A({},e),{},{validation:[].concat(c(e.validation),c(t.value))});case"CLEAR_VALIDATION_ERRORS":return t.attribute?A(A({},e),{},{isInvalid:0,validation:e.validation.filter((function(e){var r;return(null==e||null===(r=e.data)||void 0===r?void 0:r.attribute)!==t.attribute}))}):A(A({},e),{},{isInvalid:0,validation:[]})}return e},modelErrors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.type,n=t.name,o=t.payload;switch(r){case"ADD_MODEL_ERRORS":return A(A({},e),{},a({},n,[].concat(c(e[n]||[]),c((0,_.castArray)(o)))));case"CLEAR_MODEL_ERRORS":return A(A({},e),{},a({},n,[]))}return e},modal:function(e,t){return"SET_MODAL"===t.type?t.value:e},snackbar:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;switch(r.type){case"ADD_SNACKBAR_NOTICE":return[].concat(c(t),[A({id:t.length,className:"error"===(null==r||null===(e=r.notice)||void 0===e?void 0:e.type)?"is-snackbar-error":""},r.notice)]);case"REMOVE_SNACKBAR_NOTICE":return t.filter((function(e){return e.id!==r.id}));case"SAVE_ERROR":return[].concat(c(t),[{id:t.length,className:"is-snackbar-error",content:(null==r?void 0:r.message)||__("Something went wrong.","surecart")}])}return t}});var L=m().mark(q);function C(e){return{type:"SET_SAVING",value:e}}function U(e){return{type:"SET_MODAL",value:!!e&&"upgrade"}}function V(e){return{type:"SET_INVALID",value:e}}function N(e){return{type:"SET_ERROR",value:e}}function F(e){return{type:"SET_FLASH",value:e}}function z(e){return{type:"ADD_ERRORS",value:e}}function q(e,t){return m().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",{type:"ADD_MODEL_ERRORS",name:e,payload:t});case 1:case"end":return r.stop()}}),L)}function H(e){return{type:"CLEAR_MODEL_ERRORS",name:e}}function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"CLEAR_ERRORS",index:e}}function B(e){return{type:"ADD_VALIDATION_ERRORS",value:e}}function Y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:"CLEAR_VALIDATION_ERRORS",attribute:e}}function $(e){return{type:"ADD_SNACKBAR_NOTICE",notice:e}}function G(e){return{type:"REMOVE_SNACKBAR_NOTICE",id:e}}var K="surecart/ui",J=["path","query"];function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"FETCH_FROM_API",options:e}},ee=function(e){return{type:"BATCH_SAVE",batches:e}},te=function(e){var t=e.path,r=e.query,n=g(e,J);return E()(X(X({},n||{}),{},{path:(0,w.addQueryArgs)("surecart/v1/".concat(t),r)}))},re={FETCH_FROM_API:function(e){return h(m().mark((function t(){var r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.options,t.next=3,te(r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},BATCH_SAVE:function(e){return h(m().mark((function t(){var r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.batches,t.next=3,Promise.all(r.map(function(){var e=h(m().mark((function e(t){var r,n,o,u,c,s;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.key,n=t.request,o=t.index,u=void 0===o?null:o,e.prev=1,e.next=4,te(n);case 4:if(!(c=e.sent)||null==c||!c.id){e.next=10;break}return e.next=8,(0,i.dispatch)(ir).updateModel(r,c,u);case 8:return e.next=10,(0,i.dispatch)(ir).removeDirty(r,u);case 10:e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(1),null!==e.t0&&void 0!==e.t0&&e.t0.message&&(0,i.dispatch)(K).addErrors([(s={index:u,key:r},a(s,"index",u),a(s,"error",e.t0),s)]),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(_x){return e.apply(this,arguments)}}()));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},BATCH_SAVE_DRAFTS:function(e){return h(m().mark((function t(){var r;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.batches,t.next=3,Promise.all(r.map(function(){var e=h(m().mark((function e(t){var r,n,o,u,c;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.key,n=t.request,o=t.index,u=void 0===o?null:o,e.prev=1,e.next=4,te(n);case 4:if(!(c=e.sent)||null==c||!c.id){e.next=8;break}return e.next=8,(0,i.dispatch)(ir).updateDraft(r,c,u);case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()}},ne=window.wp.coreData,oe=["id"];function ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ce=function(e,t){return e.config.find((function(e){return e.name===t}))},ae=function(e,t){return e.config.find((function(e){return e.name===t}))},se=function(e){return e.config},le=function(e,t){return e.config.find((function(e){return e.name===t}))},fe=function(e,t,r){var n=ce(e,t);return n?(0,w.addQueryArgs)(n.editLink,{id:r}):null},de=function(){return(0,w.getQueryArg)(window.location,"id")},pe=function(){return!!de()},ve=function(e){return e.error},ye=function(e){return e.entities},he=function(e,t){var r;return Object.values((null===(r=e.entities)||void 0===r?void 0:r[t])||{})},ge=function(e,t,r){var n,o;return null===(n=e.entities)||void 0===n||null===(o=n[t])||void 0===o?void 0:o[r]},be=function(e,t,r,n){var o=ge(e,t,r);return!!o&&(n.split(".").forEach((function(t){o=me(e,o,t)})),o)},me=function(e,t,r){var n,o=r;return"current_period"===r&&(o="period"),Object.values((null==e||null===(n=e.entities)||void 0===n?void 0:n[o])||{}).find((function(e){return e.id===(null==t?void 0:t[r])}))},Oe=function(e){return e.dirty},Ee=function(e){return Object.values(e.drafts||{}).filter((function(e){return e.some((function(e){return!(null!=e&&e.id)}))}))},we=function(e,t){var r;return Object.values((null===(r=e.drafts)||void 0===r?void 0:r[t])||{}).filter((function(e){return!(null!=e&&e.id)}))},_e=function(e,t,r){var n,o;return(null===(n=e.drafts)||void 0===n||null===(o=n[t])||void 0===o?void 0:o[r])||[]},Se=function(e){return!!Object.keys(e.dirty||{}).length},Ae=function(e,t){var r,n,o=ge(e,t);return null==o||!o.id||(null===(r=Object.keys((null==e||null===(n=e.dirty)||void 0===n?void 0:n[o.id])||{}))||void 0===r?void 0:r.length)},De=(0,i.createRegistrySelector)((function(e){return function(){return e(K).isSaving()}}));function Re(e,t,r){var n,o,i=r.id?"".concat(null===(n=entity)||void 0===n?void 0:n.baseURL,"/").concat(r.id):null===(o=entity)||void 0===o?void 0:o.baseURL;return{path:(0,w.addQueryArgs)(i,entity.baseURLParams),method:r.id?"PATCH":"POST",data:r}}function je(e,t,r){var n=r.id,o=g(r,oe),i=ce(e,t),u=n?"".concat(null==i?void 0:i.baseURL,"/").concat(n):null==i?void 0:i.baseURL;return{path:(0,w.addQueryArgs)(u,ue(ue({},null!=i&&i.baseURLParams?i.baseURLParams:{}),o))}}var xe=(0,i.createRegistrySelector)((function(e){return function(t,r,n,o){return e(ne.store).getEntityRecords(r,n,o).map((function(e){}))}}));function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e,t,r){return t&&ke(e.prototype,t),r&&ke(e,r),e}function Te(){return Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Te.apply(this,arguments)}function Me(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function Ie(e){return!(!e||"function"!=typeof e.hasOwnProperty||!(e.hasOwnProperty("__ownerID")||e._map&&e._map.hasOwnProperty("__ownerID")))}function Le(e,t,r){return Object.keys(e).reduce((function(t,n){var o=""+n;return t.has(o)?t.set(o,r(t.get(o),e[o])):t}),t)}var Ce=function(){function e(e,t,r){if(void 0===t&&(t={}),void 0===r&&(r={}),!e||"string"!=typeof e)throw new Error("Expected a string key for Entity, but found "+e+".");var n=r,o=n.idAttribute,i=void 0===o?"id":o,u=n.mergeStrategy,c=void 0===u?function(e,t){return Te({},e,t)}:u,a=n.processStrategy,s=void 0===a?function(e){return Te({},e)}:a,l=n.fallbackStrategy,f=void 0===l?function(e,t){}:l;this._key=e,this._getId="function"==typeof i?i:function(e){return function(t){return Ie(t)?t.get(e):t[e]}}(i),this._idAttribute=i,this._mergeStrategy=c,this._processStrategy=s,this._fallbackStrategy=f,this.define(t)}var t=e.prototype;return t.define=function(e){this.schema=Object.keys(e).reduce((function(t,r){var n,o=e[r];return Te({},t,((n={})[r]=o,n))}),this.schema||{})},t.getId=function(e,t,r){return this._getId(e,t,r)},t.merge=function(e,t){return this._mergeStrategy(e,t)},t.fallback=function(e,t){return this._fallbackStrategy(e,t)},t.normalize=function(e,t,r,n,o,i){var u=this,c=this.getId(e,t,r),a=this.key;if(a in i||(i[a]={}),c in i[a]||(i[a][c]=[]),i[a][c].some((function(t){return t===e})))return c;i[a][c].push(e);var s=this._processStrategy(e,t,r);return Object.keys(this.schema).forEach((function(t){if(s.hasOwnProperty(t)&&"object"==typeof s[t]){var r=u.schema[t],c="function"==typeof r?r(e):r;s[t]=n(s[t],s,t,c,o,i)}})),o(this,s,e,t,r),c},t.denormalize=function(e,t){var r=this;return Ie(e)?Le(this.schema,e,t):(Object.keys(this.schema).forEach((function(n){if(e.hasOwnProperty(n)){var o=r.schema[n];e[n]=t(e[n],o)}})),e)},Pe(e,[{key:"key",get:function(){return this._key}},{key:"idAttribute",get:function(){return this._idAttribute}}]),e}(),Ue=function(){function e(e,t){t&&(this._schemaAttribute="string"==typeof t?function(e){return e[t]}:t),this.define(e)}var t=e.prototype;return t.define=function(e){this.schema=e},t.getSchemaAttribute=function(e,t,r){return!this.isSingleSchema&&this._schemaAttribute(e,t,r)},t.inferSchema=function(e,t,r){if(this.isSingleSchema)return this.schema;var n=this.getSchemaAttribute(e,t,r);return this.schema[n]},t.normalizeValue=function(e,t,r,n,o,i){var u=this.inferSchema(e,t,r);if(!u)return e;var c=n(e,t,r,u,o,i);return this.isSingleSchema||null==c?c:{id:c,schema:this.getSchemaAttribute(e,t,r)}},t.denormalizeValue=function(e,t){var r=Ie(e)?e.get("schema"):e.schema;return this.isSingleSchema||r?t((this.isSingleSchema?void 0:Ie(e)?e.get("id"):e.id)||e,this.isSingleSchema?this.schema:this.schema[r]):e},Pe(e,[{key:"isSingleSchema",get:function(){return!this._schemaAttribute}}]),e}(),Ve=function(e){function t(t,r){if(!r)throw new Error('Expected option "schemaAttribute" not found on UnionSchema.');return e.call(this,t,r)||this}Me(t,e);var r=t.prototype;return r.normalize=function(e,t,r,n,o,i){return this.normalizeValue(e,t,r,n,o,i)},r.denormalize=function(e,t){return this.denormalizeValue(e,t)},t}(Ue),Ne=function(e){function t(){return e.apply(this,arguments)||this}Me(t,e);var r=t.prototype;return r.normalize=function(e,t,r,n,o,i){var u=this;return Object.keys(e).reduce((function(t,r,c){var a,s=e[r];return null!=s?Te({},t,((a={})[r]=u.normalizeValue(s,e,r,n,o,i),a)):t}),{})},r.denormalize=function(e,t){var r=this;return Object.keys(e).reduce((function(n,o){var i,u=e[o];return Te({},n,((i={})[o]=r.denormalizeValue(u,t),i))}),{})},t}(Ue),Fe=function(e){return Array.isArray(e)?e:Object.keys(e).map((function(t){return e[t]}))},ze=function(e,t,r,n,o,i,u){return e=function(e){if(Array.isArray(e)&&e.length>1)throw new Error("Expected schema definition to be a single schema, but found "+e.length+".");return e[0]}(e),Fe(t).map((function(t,c){return o(t,r,n,e,i,u)}))},qe=function(e){function t(){return e.apply(this,arguments)||this}Me(t,e);var r=t.prototype;return r.normalize=function(e,t,r,n,o,i){var u=this;return Fe(e).map((function(e,c){return u.normalizeValue(e,t,r,n,o,i)})).filter((function(e){return null!=e}))},r.denormalize=function(e,t){var r=this;return e&&e.map?e.map((function(e){return r.denormalizeValue(e,t)})):e},t}(Ue),He=function(e,t,r,n,o,i,u){var c=Te({},t);return Object.keys(e).forEach((function(r){var n=e[r],a="function"==typeof n?n(t):n,s=o(t[r],t,r,a,i,u);null==s?delete c[r]:c[r]=s})),c},Qe=function(e,t,r){if(Ie(t))return Le(e,t,r);var n=Te({},t);return Object.keys(e).forEach((function(t){null!=n[t]&&(n[t]=r(n[t],e[t]))})),n},Be=function(){function e(e){this.define(e)}var t=e.prototype;return t.define=function(e){this.schema=Object.keys(e).reduce((function(t,r){var n,o=e[r];return Te({},t,((n={})[r]=o,n))}),this.schema||{})},t.normalize=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return He.apply(void 0,[this.schema].concat(t))},t.denormalize=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Qe.apply(void 0,[this.schema].concat(t))},e}(),Ye=function e(t,r,n,o,i,u){return"object"==typeof t&&t?"object"!=typeof o||o.normalize&&"function"==typeof o.normalize?o.normalize(t,r,n,e,i,u):(Array.isArray(o)?ze:He)(o,t,r,n,e,i,u):t},$e={Array:qe,Entity:Ce,Object:Be,Union:Ve,Values:Ne},Ge=function(e,t){if(!e||"object"!=typeof e)throw new Error('Unexpected input given to normalize. Expected type to be "object", found "'+(null===e?"null":typeof e)+'".');var r={},n=function(e){return function(t,r,n,o,i){var u=t.key,c=t.getId(n,o,i);u in e||(e[u]={});var a=e[u][c];e[u][c]=a?t.merge(a,r):r}}(r);return{entities:r,result:Ye(e,e,null,t,n,{})}},Ke=a({integration:new $e.Entity("integration"),account:new $e.Entity("account"),price:new $e.Entity("price"),product:new $e.Entity("product"),product_group:new $e.Entity("product_group"),purchase:new $e.Entity("purchase"),payment_method:new $e.Entity("payment_method"),card:new $e.Entity("card"),invoice:new $e.Entity("invoice"),current_period:new $e.Entity("current_period"),refund:new $e.Entity("refund"),charge:new $e.Entity("charge"),coupon:new $e.Entity("coupon"),promotion:new $e.Entity("promotion"),order:new $e.Entity("order"),customer:new $e.Entity("customer"),subscription:new $e.Entity("subscription")},"product_group",new $e.Entity("product_group")),Je=Ke.price,We=Ke.product,Xe=Ke.purchase,Ze=Ke.payment_method,et=Ke.card,tt=Ke.invoice,rt=Ke.refund,nt=Ke.charge,ot=Ke.coupon,it=Ke.promotion,ut=Ke.order,ct=Ke.integration,at=Ke.customer,st=Ke.product_group,lt=Ke.subscription;We.define({prices:{data:[Je]},product_group:st}),Je.define({product:We}),tt.define({purchases:{data:[Xe]},charge:nt,customer:at,subscription:lt}),ut.define({purchases:{data:[Xe]},charge:nt,customer:at,subscription:lt}),nt.define({order:ut,invoice:tt}),lt.define({current_period:tt,purchase:Xe,price:Je,payment_method:Ze,order:ut,customer:at}),rt.define({charge:nt,customer:at}),Xe.define({order:ut,product:We,subscription:lt}),Ze.define({card:et}),ot.define({promotions:{data:[it]}}),st.define({}),ct.define({});var ft=["query"],dt=["query","data","path"],pt=["id","key","query","data","path"],vt=["query","data","path"],yt=["query","data","path"];function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var bt=m().mark(Ut),mt=m().mark(qt),Ot=m().mark(Ht),Et=m().mark(Qt),wt=m().mark(Bt),_t=m().mark(Yt),St=m().mark($t),At=m().mark(Gt),Dt=m().mark(Kt),Rt=m().mark(Wt),jt=m().mark(Xt),xt=m().mark(Zt),kt=m().mark(er),Pt=m().mark(tr),Tt=m().mark(rr);function Mt(e){return{type:"SET_ERROR",payload:e}}function It(e){return{type:"REGISTER_ENTITIES",payload:e}}function Lt(e){return{type:"SET_MODELS",payload:e}}function Ct(e){return{type:"ADD_MODELS",payload:e}}function Ut(e,t,r){return m().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",{type:"UPDATE_MODELS_PROPERTY",payload:r,key:e,prop:t});case 1:case"end":return n.stop()}}),bt)}function Vt(e,t){return{type:"UPDATE_MODELS",payload:t,key:e}}function Nt(e){return{type:"ADD_MODEL",payload:e}}function Ft(e,t){return{type:"ADD_DRAFT",name:e,payload:t}}function zt(e){return Nt(e)}function qt(e,t,r){return m().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.controls.dispatch(ir,"updateDirty",t,r);case 2:return n.abrupt("return",{type:"UPDATE_MODEL",name:e,id:t,payload:r});case 3:case"end":return n.stop()}}),mt)}function Ht(e){var t,r,n,o,u,c,a,s,l,f;return m().wrap((function(d){for(;;)switch(d.prev=d.next){case 0:p=Array.isArray(e)?e:[e],v=void 0,y=void 0,t=(null!=Ke&&Ke[null==p||null===(v=p[0])||void 0===v?void 0:v.object]?Ge(p,[Ke[null==p||null===(y=p[0])||void 0===y?void 0:y.object]]):{})||{},r=t.entities,n=0,o=Object.keys(r||{});case 3:if(!(n<o.length)){d.next=19;break}u=o[n],c=r[u],a=0,s=Object.keys(c||{});case 7:if(!(a<s.length)){d.next=16;break}return f=s[a],d.next=11,i.controls.dispatch(ir,"addModel",c[f]);case 11:return d.next=13,i.controls.dispatch(ir,"removeDirty",null===(l=c[f])||void 0===l?void 0:l.id);case 13:a++,d.next=7;break;case 16:n++,d.next=3;break;case 19:case"end":return d.stop()}var p,v,y}),Ot)}function Qt(e,t){return m().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,{type:"UPDATE_DIRTY",id:e,payload:t};case 2:case"end":return r.stop()}}),Et)}function Bt(e){var t,r,n=arguments;return m().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=n.length>1&&void 0!==n[1]?n[1]:0,r=n.length>2?n[2]:void 0,o.next=4,{type:"UPDATE_DRAFT",name:e,index:t,payload:r};case 4:case"end":return o.stop()}}),wt)}function Yt(e,t){var r;return m().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Z({path:(0,w.addQueryArgs)("".concat(e,"s/").concat(t),{context:"edit"}),method:"DELETE"});case 3:r=n.sent,n.next=9;break;case 6:throw n.prev=6,n.t0=n.catch(0),n.t0;case 9:if(!r){n.next=13;break}return n.next=12,i.controls.dispatch(K,"addSnackbarNotice",{content:(0,s.__)("Deleted.","surecart")});case 12:return n.abrupt("return",{type:"DELETE_MODEL",id:t,name:e});case 13:throw{message:"Failed to delete."};case 14:case"end":return n.stop()}}),_t,null,[[0,6]])}function $t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,{type:"REMOVE_DIRTY",id:e};case 2:case"end":return t.stop()}}),St)}function Gt(e,t){return m().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,{type:"REMOVE_DRAFT",name:e,index:t};case 2:case"end":return r.stop()}}),At)}function Kt(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,{type:"CLEAR_DRAFTS",name:e};case 2:case"end":return t.stop()}}),Dt)}function Jt(){return{type:"CLEAR_DIRTY"}}function Wt(e,t){var r,n,o,u,c,a=arguments;return m().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},n=r.query,o=g(r,ft),l.next=3,i.controls.dispatch(K,"clearModelErrors",e);case 3:return u=null!=t&&t.id?"".concat(e,"s/").concat(null==t?void 0:t.id):"".concat(e,"s"),l.next=6,Z(gt({path:(0,w.addQueryArgs)(u,gt({context:"edit"},n||{})),method:null!=t&&t.id?"PATCH":"POST",data:t},o));case 6:if((c=l.sent)&&null!=c&&c.id){l.next=9;break}throw{message:(0,s.__)("Failed to save.","surecart")};case 9:return l.next=11,i.controls.dispatch(ir,"receiveModels",c);case 11:return l.abrupt("return",c);case 12:case"end":return l.stop()}}),Rt)}function Xt(e,t){var r,n,o,u,c,a,l,f,d,p,v=arguments;return m().wrap((function(y){for(;;)switch(y.prev=y.next){case 0:return r=v.length>2&&void 0!==v[2]?v[2]:{},n=r.query,o=r.data,u=r.path,c=g(r,dt),y.next=3,i.controls.dispatch(K,"clearModelErrors",e);case 3:return y.next=5,i.controls.resolveSelect(ir,"selectDirty");case 5:if(a=y.sent,l=t?"".concat(e,"s/").concat(t):"".concat(e,"s"),f=u||l,d=Object.keys(o||{}).length?o:null==a?void 0:a[t],Object.keys(d||{}).length||u){y.next=11;break}return y.abrupt("return");case 11:return y.next=13,Z(gt({path:(0,w.addQueryArgs)(f,gt({context:"edit"},n||{})),method:t?"PATCH":"POST",data:d},c));case 13:if((p=y.sent)&&null!=p&&p.id){y.next=16;break}throw{message:(0,s.__)("Failed to save.","surecart")};case 16:return y.next=18,i.controls.dispatch(ir,"receiveModels",p);case 18:case"end":return y.stop()}}),jt)}function Zt(e){var t,r,n,o,i,u,c,a;return m().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.id,r=e.key,n=e.query,o=e.data,i=e.path,u=g(e,pt),c=t?"".concat(r,"s/").concat(t):"".concat(r,"s"),a=i||c,s.next=5,Z(gt({path:(0,w.addQueryArgs)(a,gt({context:"edit"},n||{})),method:t?"PATCH":"POST",data:o},u));case 5:return s.abrupt("return",s.sent);case 6:case"end":return s.stop()}}),xt)}function er(e){var t,r,n,o=arguments;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=o.length>1&&void 0!==o[1]?o[1]:{}).query,t.data,t.path,g(t,vt),e.next=3,i.controls.dispatch(K,"setSaving",!0);case 3:return e.next=5,i.controls.dispatch(K,"clearModelErrors",key);case 5:return e.next=7,i.controls.resolveSelect(ir,"selectDrafts",key);case 7:if(null!=(r=e.sent)&&r.length){e.next=10;break}return e.abrupt("return",!1);case 10:return n=[],r.forEach((function(e){r.forEach((function(t,r){n.push({key:e,request:or(t,entity),index:r})}))})),e.next=14,ee(n);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),kt)}function tr(e,t){var r,n,o,u,c,a,l=arguments;return m().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return r=l.length>2&&void 0!==l[2]?l[2]:{},n=r.query,o=r.data,r.path,u=g(r,yt),f.next=3,i.controls.dispatch(K,"clearModelErrors",e);case 3:return f.next=5,i.controls.resolveSelect(ir,"selectDraft",e,t);case 5:if(c=f.sent,Object.keys(c||{}).length){f.next=8;break}return f.abrupt("return",!1);case 8:return f.next=10,Zt(gt({key:e,query:n,data:gt(gt({},c),o)},u));case 10:if((a=f.sent)&&null!=a&&a.id){f.next=13;break}throw{message:(0,s.__)("Failed to save.","surecart")};case 13:return f.next=15,i.controls.dispatch(ir,"updateDraft",e,t,a);case 15:return f.next=17,i.controls.dispatch(ir,"receiveModels",a);case 17:return f.abrupt("return",a);case 18:case"end":return f.stop()}}),Pt)}function rr(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.controls.dispatch(ir,"updateModel",e);case 2:return t.next=4,i.controls.dispatch(ir,"removeDirty",null==e?void 0:e.id);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),Tt)}function nr(e,t){return null==e||!e.id||Object.keys((null==t?void 0:t[null==e?void 0:e.id])||{}).length}function or(e,t){var r=e.id?"".concat(null==t?void 0:t.baseURL,"/").concat(e.id):null==t?void 0:t.baseURL;return{path:(0,w.addQueryArgs)(r,t.baseURLParams),method:e.id?"PATCH":"POST",data:e}}var ir="surecart/core-data",ur={reducer:v,selectors:n,controls:re,actions:o};(0,i.registerStore)(ir,ur)}()}();